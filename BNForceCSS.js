function bn_forceCSS() { var styleSheets = document.styleSheets; for (var i = 0; i < styleSheets.length; i++) { var styleSheet = document.styleSheets[i]; var mediaList = styleSheet.media; for (var j = 0; j < mediaList.length; j++) { var media = mediaList[i].toLowerCase(); if (media == 'print') { return 'HAD print CSS'; } else if (media == 'all') { return 'HAD all CSS'; } } } for (var i = 0; i < styleSheets.length; i++) { var styleSheet = document.styleSheets[i]; var mediaList = styleSheet.media; var hasScreenStyleSheet = false; for (var j = 0; j < mediaList.length; j++) { var media = mediaList[i].toLowerCase(); if (media == 'screen') { hasScreenStyleSheet = true; } else if (media == 'all') { hasScreenStyleSheet = true; } if (hasScreenStyleSheet) { styleSheet.media.appendMedium('print'); break; } } } return 'FORCED print CSS'; }